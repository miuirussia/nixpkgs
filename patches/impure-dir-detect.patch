From 1410cf9a611a689bd257e8b27d48723929723eb6 Mon Sep 17 00:00:00 2001
From: Kirill Kuznetsov <kdevlab@yandex.ru>
Date: Wed, 3 May 2023 10:37:51 +0300
Subject: [PATCH] Fix directory detect

---
 pkgs/top-level/impure.nix | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/pkgs/top-level/impure.nix b/pkgs/top-level/impure.nix
index 4d847e280f4b9..9e8f43de6d92e 100644
--- a/pkgs/top-level/impure.nix
+++ b/pkgs/top-level/impure.nix
@@ -37,7 +37,7 @@ in
   # collections of packages.  These collection of packages are part of the
   # fix-point made by Nixpkgs.
   overlays ? let
-      isDir = path: builtins.pathExists (path + "/.");
+      isDir = path: builtins.readFileType path == "directory";
       pathOverlays = try (toString <nixpkgs-overlays>) "";
       homeOverlaysFile = homeDir + "/.config/nixpkgs/overlays.nix";
       homeOverlaysDir = homeDir + "/.config/nixpkgs/overlays";
